<!DOCTYPE html>
<html>
  <head>
      <link rel="stylesheet" href="stylesheets/tailwind-output.css">
  </head>
  <body>

<%- include nav %>

          <section>
            <div class="px-4 py-12 mx-auto max-w-7xl sm:px-6 md:px-12 lg:px-24 lg:py-24">
              <div class="
            justify-center
            mx-auto
            text-left
            align-bottom
            transition-all
            transform
            bg-white
            rounded-lg
            sm:align-middle sm:max-w-2xl sm:w-full
          ">
                <div class="
              grid
              flex-wrap
              items-center
              justify-center
              grid-cols-1
              mx-auto
              shadow-xl
              lg:grid-cols-2
              rounded-xl
            ">
                  <div class="w-full px-6 py-3">
                    <div>
                      <div class="mt-3 text-left sm:mt-5">
                        <div class="inline-flex items-center w-full">
                          <h3 class="
                        text-lg
                        font-bold
                        text-neutral-600
                        l
                        eading-6
                        lg:text-5xl
                      "> Sign up </h3>
                        </div>
                        <div class="mt-4 text-base text-gray-300">
                          <p>Sign up and get our newest news.</p>
                        </div>
                      </div>
                    </div>
                    <div class="mt-6 space-y-2">
                      <form id="login-form" class="mt-8 space-y-6" action="#" method="POST">
      <input type="hidden" name="remember" value="true">
      <div class="rounded-md shadow-sm -space-y-px">
        <div>
          <label for="email-input" class="sr-only">Email</label>
          <input id="email" name="email-input" type="email" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="Email address">
        </div>

<br>

<div>
          <label for="username-input" class="sr-only">Username</label>
          <input id="username" name="username" type="text" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="Username">
        </div>

<br>

        <div>
          <label for="password-input" class="sr-only">Password</label>
          <input id="password" name="password" type="password" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="Password">
        </div>
      </div>
                      <div class="flex flex-col mt-4 lg:space-y-2">
                              <div>
        <button type="submit" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-500 hover:bg-blue-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
          <span class="absolute left-0 inset-y-0 flex items-center pl-3">
            <!-- Heroicon name: solid/lock-closed -->
            <svg class="h-5 w-5 text-blue-400 group-hover:text-blue-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
            </svg>
          </span>
          Sign Up
        </button>
      </div>
    </form>
                      <div class="inline-flex
                      justify-center
                      py-4
                      text-base
                      font-medium
                      focus:outline-none
                      sm:text-sm"><div class="text-center mt-4 text-base text-black">
                          <p class="inline" >Already have an account?</p>
                          <div class="inline mt-4 text-base text-blue-500 hover:text-blue-400">
                              <a href="/login">Log In</a>
                          </div></div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="order-first hidden w-full lg:block">
                    <img class="object-cover h-full bg-cover rounded-l-lg" src="https://images.unsplash.com/photo-1590487988256-9ed24133863e?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MjB8fGd5bXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=1000&q=80" alt="">
                  </div>
                </div>
              </div>
            </div>
          </section>

<script>

          let url = fetch("http://127.0.0.1:8000/register", {
                  method: 'POST',
                  headers: {
                 'Accept': 'application/json',
                 'Content-Type': 'application/json'
                  }});

         console.log(url);

         function formValidator(event) {
              event.preventDefault();

              let email_address = document.getElementById("email").value;
              let uname = document.getElementById("username").value;
              let pass = document.getElementById("password").value;

              if(email_address == "") {
                  alert("Email cannot be null");
              }
              else if (uname == "") {
                  alert("Username cannot be null");
              }
              else if (pass == "") {
                  alert("Password cannot be null");
              }
              else {
   
                  fetch("http://127.0.0.1:8000/register/", {
                  method: 'POST',
                  headers: {
                 'Accept': 'application/json',
                 'Content-Type': 'application/json'
                  },
                  body: JSON.stringify({username: uname, email: email_address, password: pass})
                  }).then(response=>response.json())
                  .then(data=>{
                      let data_returned = JSON.stringify(data);
                      console.log(data.username);
                      if(data.username == "A user with that username already exists.") {
                          alert("This username is taken. Choose another username");
                      }
                      else {
                          alert("Account Created Successfully. You will be redirected to the login page");
                          window.location.href = "/login";
                          console.log(data);
                      }
                   });


              }

          }

          let login = document.getElementById("login-form");
          login.addEventListener('submit', formValidator);

</script>


  </body>

<%- include footer %>
</html>

<!--https://blocks.wickedtemplates.com/auth-->
